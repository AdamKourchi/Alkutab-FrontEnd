@if(loading){
<div class="flex justify-center items-center h-100">
  <mat-progress-spinner color="primary" mode="indeterminate"></mat-progress-spinner>
</div>
}@else{
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mx-32 my-5">
  @for(exam of exams; track exam.id){
  <mat-card class="exam-card !border-2 !border-gray-300">
    <mat-card-header>
      <mat-card-title>{{ exam.title }}</mat-card-title>
      <mat-card-subtitle>
        <span [ngClass]="{
          'text-yellow-600': !canTakeExam(exam) && !hasAnsweredExam(exam.id),
          'text-green-600': canTakeExam(exam),
          'text-blue-600': hasAnsweredExam(exam.id)
        }">
          {{ 
            hasAnsweredExam(exam.id) ? 'تم الإجابة' :
            canTakeExam(exam) ? 'متاح الآن' :
            'قادم'
          }}
        </span>
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <div class="mt-4">
        <p>
          <strong>نوع الإختبار:</strong>
          {{ exam?.examType == "oral" ? "شفهي" : "تحريري" }}
        </p>
        <p><strong>المدة:</strong> {{ exam?.duration }} دقيقة</p>
        @if(exam.examType != "oral"){
        <p><strong>عدد الأسئلة:</strong> {{ exam?.questions?.length }}</p>
        }
        <p>
          <strong>تاريخ الإختبار:</strong> {{ exam.startTime | date:'medium' }}
        </p>
        @if(exam?.description){
        <p><strong>الوصف:</strong> {{ exam.description }}</p>
        }
      </div>
    </mat-card-content>

    <mat-card-actions class="flex justify-end gap-2 p-4">
      @if(canTakeExam(exam) && !hasAnsweredExam(exam.id)){
      <button mat-flat-button color="primary" (click)="takeExam(exam)">
        <mat-icon>edit</mat-icon>
        إجراء الاختبار
      </button>
      }
    </mat-card-actions>
  </mat-card>
  }
</div>
}
