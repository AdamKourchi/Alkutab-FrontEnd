<div class="flex mx-32">
  <!-- Left: Student Details -->
  <div class="flex-1 p-6">
    @if(!loading){
    <ng-container >
      <mat-card
        appearance="outlined"
        class="!shadow-md !p-5 text-white"
        id="card"
      >
        <p class="mb-4 zahey text-2xl">مسار : {{ circle?.path?.name }}.</p>

        <div class="flex justify-between items-center almarai text-xl">
          <p>حلقة : {{ circle?.title }}</p>
        </div>
      </mat-card>

      @if(selectedStudent) {

      <ng-container>
        <div class="mb-6 flex items-center justify-between">
          <div class="almarai">
            <h2 class="text-2xl font-bold my-2">{{ selectedStudent.name }}</h2>
            <p>العمر: {{ selectedStudent.enrollmentRequests?.[0]?.age }}</p>
            <p>
              <span>المستوى الدراسي:</span>
              {{
                getEducationLevelArabic(selectedStudent.enrollmentRequests?.[0]?.educationLevel)
              }}
            </p>
          </div>
          <div class="flex gap-2">
            <button mat-flat-button (click)="openAddWajibDialog()">
              <mat-icon>add</mat-icon>
              إضافة واجب
            </button>
            <button (click)="drawer.toggle()" mat-stroked-button>الطلبة</button>
          </div>
        </div>
        <mat-card>
          <mat-card-content>
            <app-tabulator-table
              [data]="wajibs"
              [columns]="collums"
              (cellEdited)="onCellEdited($event)"
              [options]="options"
            ></app-tabulator-table>
          </mat-card-content>
        </mat-card>
      </ng-container>

      }@else {
      <ng-container>
        <p class="text-gray-500">لا يوجد طلبة في هذه الحلقة.</p>
      </ng-container>
      }
    </ng-container>
    }@else {
    <ng-template>
      <div class="flex items-center justify-center h-full">
        <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
      </div>
    </ng-template>
    }
  </div>

  <!-- Right: Student List -->
  <mat-drawer-container class="example-container" autosize>
    <mat-drawer #drawer class="example-sidenav" mode="side">
      <mat-nav-list>
        @for (student of students; track $index) { @if($index ===
        selectedStudentIndex){
        <mat-list-item
          (click)="selectStudent($index)"
          class="rounded mb-2 transition border-green-700 border-1 cursor-pointer"
        >
          <span>{{ student.name }}</span>
        </mat-list-item>
        }@else{
        <mat-list-item
          (click)="selectStudent($index)"
          class="rounded mb-2 transition cursor-pointer"
        >
          <span>{{ student.name }}</span>
        </mat-list-item>
        } }
      </mat-nav-list>
    </mat-drawer>
  </mat-drawer-container>
</div>
